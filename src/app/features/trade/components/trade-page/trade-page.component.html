<div class="swap-container" *ngLet="formContent$ | async as content">
  <div class="form" [ngClass]="{ form_small: content === 'preview' }">
    <app-window-container>
      <ng-container header>
        <ng-container *ngIf="content === 'fromSelector'">
          <span (click)="handleTokenSelect('from', null)">Back</span>
          Swap Form
        </ng-container>
        <ng-container *ngIf="content === 'toSelector'">
          <span (click)="handleTokenSelect('from', null)">Back</span>
          Swap Form
        </ng-container>
        <ng-container *ngIf="content === 'form'">Rubic.exchange</ng-container>
        <ng-container *ngIf="content === 'preview'">
          <span (click)="backToForm()">Back</span>
          Preview swap
        </ng-container>
      </ng-container>
      <!-- Trade -->
      <ng-container *ngIf="content === 'form'">
        <div class="form__container">
          <app-input-output-container>
            <app-asset-selector
              left
              (handleAssetSelection)="openTokensSelect('from')"
              [asset]="fromAsset$ | async"
            ></app-asset-selector>
            <div right class="input-container">
              <app-amount-transput
                formType="from"
                [selectedToken]="fromAsset$ | async"
                inputMode="input"
                (amountUpdated)="updateInputValue($event)"
                [amountValue]="fromAmount$ | async"
              ></app-amount-transput>
            </div>
          </app-input-output-container>

          <app-input-output-container>
            <app-asset-selector
              left
              (handleAssetSelection)="openTokensSelect('to')"
              [asset]="toAsset$ | async"
            ></app-asset-selector>
            <div right class="input-container">
              <app-amount-transput
                formType="to"
                [selectedToken]="toAsset$ | async"
                inputMode="output"
                [amountValue]="toAmount$ | async"
              ></app-amount-transput>
            </div>
          </app-input-output-container>
        </div>

        <ng-container footer>
          <div class="buttons-container">
            <app-action-button></app-action-button>
            <app-receiver-address-button></app-receiver-address-button>
          </div>
        </ng-container>
      </ng-container>
      <ng-container *ngIf="content === 'fromSelector'">
        <app-assets-selector-page
          [type]="'from'"
          (tokenSelect)="handleTokenSelect('from', $event)"
        ></app-assets-selector-page>
      </ng-container>
      <ng-container *ngIf="content === 'toSelector'">
        <app-assets-selector-page
          [type]="'to'"
          (tokenSelect)="handleTokenSelect('to', $event)"
        ></app-assets-selector-page>
      </ng-container>
      <ng-container *ngIf="content === 'preview'">
        <app-preview-swap></app-preview-swap>
      </ng-container>
    </app-window-container>
  </div>

  <app-providers-list
    *ngIf="(showProviders$ | async) && content === 'form'"
    @inOutAnimation
    [states]="providers$ | async"
    [selectedTradeType]="selectedTradeType$ | async"
    (selectTrade)="selectTrade($event)"
  ></app-providers-list>
</div>
